<!DOCTYPE html>
<html>
    <head>
        <title>ex6_progress</title>
        <meta charset="EUC-KR">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <script>
            /*
             var inter;
             function startProgress(){
             var pp = document.getElementById("rr");
             pp.value += 0.1;
             console.log(pp.value);
             if(pp.value === 100){
             clearInterval(inter);
             }
             }
             function intervalProgress(){
             inter = setInterval(startProgress, 0);
             }
             */
            var inter = null; // 인터벌객체
            // 현재창이 불려질 때를 인식하여
            // 바로 시작하는 이벤트
            // 익명 함수.
            // 동영상, 이미지 등 모든 리소스가 로드될(브라우저가 읽어들일) 때까지
            // 기다렸다가 동작됨.
            window.onload = function () {
                // 0.5초마다 gogo()함수 호출
                inter = setInterval("gogo()", 40);
            }
            // 인터벌객체에 의해 일정 시간마다 
            // 호출되는 함수
            function gogo() {
                // 현재 문서에 있는 progress바를 가져온다.
                var pp = document.getElementById("rr");
                // document.querySelector를 사용하면
                // 현재 문서안에.. 폼안.. span요소(특정 태그 요소)를
                // 얻어낸다.
                var pspan = document.querySelector(
                        "form fieldset span");
                //프로그래스 객체의 값을 변경
                pp.value = pp.value + 0.01;
                //span요소의 값도 변경한다.
                pspan.innerHTML = parseInt(pp.value * 100);
                //프로그래스 객체가 소멸되도록 한다.
                //(프로그래스 객체의 값이 1일때)
                if (pp.value >= 1) {
                    clearInterval(inter);
                    alert("끝~!");
                }
            }
        </script>
    </head>

    <body>
        <div>
            <form>
                <fieldset>
                    <label for="rr">progress:</label>
                    <progress id="rr" max="1" value="0">
                    </progress>
                    <span>40</span>%
                    <p>
                        <input type="button" value="st" onclick="intervalProgress()">
                    </p>
                </fieldset>
            </form>
        </div>
    </body>
</html>
